# Lumi单词训练营：项目状态报告与发展蓝图

文件版本： V2.3

更新日期： 2025年7月5日

负责人： Stoic42

核心理念更新： 基于对词汇记忆科学的深入研究，本项目将深度融合间隔重复、位置效应、助记法、游戏化及创造性使用等原则，旨在打造一个不仅高效，更符合认知科学的学习伙伴。

## 一、 项目核心需求 (Product Requirements)

（此部分保持不变，已全面覆盖）

| **模块 (Module)**      | **核心需求 (Core Requirements)**                                              |
| -------------------- | ------------------------------------------------------------------------- |
| **1. 核心学习闭环**        | 提供拼写/听写等多种测试模式；实现自动批改与即时反馈；精确记录每一次的错误。                                    |
| **2. 内容与数据管理**       | 支持"词书-单元-单词"的多层级结构；能从多种格式（CSV/TXT）导入并整合数据；存储单词的完整信息（音标、例句、多来源释义、多种发音等）。   |
| **3. 用户与角色系统**       | 区分学生/管理员(Admin)角色；提供安全的用户注册、登录与会话管理；实现用户数据（错题、进度）的完全隔离。                   |
| **4. 体验与交互 (UI/UX)** | 提供美观、友好、易用的操作界面；Lumi吉祥物应能根据学习状态提供丰富的情感反馈与动画；提供高质量的音频播放体验。                 |
| **5. 科学记忆引擎**        | 基于艾宾浩斯遗忘曲线，构建间隔重复系统（SRS），为每个用户智能推送定制化的复习与学习计划。                            |
| **6. 智能与数据分析**       | Admin后台能查看所有学生的整体学情报告；利用大语言模型（LLM）API对学生的错题模式进行诊断，并提供个性化建议；利用AI生成新颖的练习模式。 |
| **7. 部署与扩展**         | 支持在本地（包括低性能Windows）部署运行；具备部署到云服务器的能力；为未来扩展至独立APP或微信小程序提供穩固的API基础。         |

## 二、 当前项目完成度 (Current Status)

**项目状态：** **第一阶段 (核心MVP) 已完成并超额交付，正在进行第二阶段优化。**

|            |                                                                                   |
| ---------- | --------------------------------------------------------------------------------- |
| **模块**     | **✅ 完成情况**                                                                        |
| **环境与后端**  | 已建立稳定、独立的Anaconda开发环境；Flask后端服务、数据库连接、以及多个核心API均已开发并调通。                           |
| **核心测试闭环** | 已实现 `选择列表` -> `答题` -> `提交` -> `批改` -> `结果反馈` 的完整流程。                               |
| **数据导入**   | 已实现从TXT/CSV导入数据到SQLite数据库的自动化脚本，并初步解决了多数据源合并问题。                                   |
| **用户体验**   | 已实现精美的UI设计、Lumi吉祥物即时反馈、英/美双语音频播放、自动播放选项及快捷键支持。                                    |
| **API服务**  | 已开发出 `/api/questions`, `/api/submit`, `/api/lists`, `/api/error-history` 等多个核心接口。 |
| **错误历史系统** | ✅ **新增**：完整的错误历史记录系统，支持多维度筛选、分页加载、数据导出等功能。 |
| **数据同步** | ✅ **新增**：支持多设备数据同步，已实现Alan教室数据库与本地数据库的ErrorLogs同步功能。 |
| **正确率计算** | ✅ **新增**：修正了正确率计算逻辑，基于实际测试数据计算合理的正确率百分比。 |

## 三、 最近解决的问题 (Recently Resolved Issues)

| **问题** | **解决方案** | **完成时间** |
|---------|-------------|-------------|
| **错误历史分页限制** | 原API默认只返回50条记录，导致用户无法查看完整历史。 | 2025-07-05 |
| **正确率计算错误** | 原计算逻辑导致显示-105%等不合理数值。 | 2025-07-05 |
| **数据同步需求** | Alan教室数据与本地数据库不同步，影响学习连续性。 | 2025-07-05 |
| **JavaScript语法错误** | Git合并冲突导致fix_mess_display_new.js函数未定义。 | 2025-07-04 |

**技术改进：**
- 将API默认limit从50提升到500，并添加"加载更多"功能
- 重构正确率计算逻辑：基于用户错误单词涉及的所有列表计算总单词数
- 开发数据同步脚本，支持跨设备ErrorLogs数据合并
- 修复前端JavaScript语法错误，确保错误历史页面正常显示

## 四、 已知问题与技术债 (Known Issues & Tech Debt)

| ------- | ----------- | -------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------ |
| **#**   | **问题/技术债**  | **表现**                                                                                 | **解决方案（后续处理）**                                                                             |
| **1**   | **数据模型待优化** | **多条记录**：`center/centre` 等单词在数据源中可能是多条记录；**多义项冲突**：不同词典对同一单词有不同释义，当前扁平的`Words`表无法优雅处理。 | **长期方案**：重构数据库，建立一个核心`WordSpelling`表，以及关联的`WordDefinition`表，用`source`字段区分来源，实现真正的"一词多义"存储。 |
| **2**   | **数据字段混杂**  | `meaning_cn`列中混入了过去式/分词等语法形态，不利于程序化处理。                                                 | **中期方案**：升级`Words`表，增加专门的`form_past`等列；修改`import_data.py`脚本，在导入时进行"数据清洗"，自动分离这些信息。         |
| **3** | **导入脚本强耦合** | `import_data.py`目前强依赖于特定数据源的列顺序。                                                       | **近期方案**：**统一数据源标准**。将所有词库预处理成一种**标准格式的CSV**，然后重写一个简单、通用的导入脚本，实现"一次编写，到处导入"。               |
| **4** | **静态路径与发音问题** | 部分URL路径（如音频）在`app.py`中被部分写死；us/it等多义词或大小写敏感词的发音文件爬取存在错误。                                                           | **近期方案**：优化`app.py`，将路径前缀作为配置项，或通过更智能的方式动态生成，以支持未来更多的词库。使用环境变量或配置文件来管理这些路径。针对多义词和大小写敏感词，重新设计爬虫逻辑以获取正确的发音文件。                                   |
| **5** | **SRS功能待完善** | 间隔重复系统(SRS)功能已初步实现但需要进一步优化和测试。 | **近期方案**：完善SRS算法，增加学习进度跟踪，优化复习计划生成逻辑。 |

## 五、 用户反馈问题与优化需求 (User Feedback & Optimization Needs)

基于用户实际使用过程中的反馈，我们收集了以下需要优化的问题和功能需求：

|**问题/需求**|**描述与解决方案**|**优先级**|
|**1. 派生词学习**|需要增加派生词考核功能，帮助学生掌握单词的不同形态（名词、动词、形容词等）；开发专门的派生词测试模式。|中|
|**2. 发音问题**|解决发音按钮重复播放问题；增加音标显示；优化发音体验。|高|
|**3. 答题体验优化**|增加计时功能；优化跳过单词的处理逻辑；支持多种义项显示；解决大小写敏感性问题；增加词性切割；支持默写要求；显示错误次数。|高|
|**4. 错词导出功能**|✅ **已完成**：开发错词导出API和前端功能，支持按日期和学生ID导出错误单词列表。|✅|
|**5. 短语学习**|增加常用短语的学习和测试功能，帮助学生掌握单词在实际语境中的应用。|低|
|**6. 数据同步优化**|✅ **已完成**：支持多设备数据同步，确保学习进度连续性。|✅|
连续答对多个单词的时候有动画效果。

## 六、 下一步开发计划 (Next Development Plan)

### 短期目标 (1-2周)
1. **完善SRS功能**：优化间隔重复算法，增加学习进度可视化
2. **发音体验优化**：解决发音重复播放问题，增加音标显示
3. **答题体验提升**：增加计时功能，优化跳过逻辑

### 中期目标 (1个月)
1. **数据模型重构**：优化数据库结构，支持一词多义
2. **导入脚本标准化**：统一数据源格式，简化导入流程
3. **派生词学习功能**：开发专门的派生词测试模式

### 长期目标 (3个月)
1. **AI智能诊断**：集成LLM API，提供个性化学习建议
2. **移动端适配**：优化移动端体验，为小程序开发做准备
3. **云部署方案**：完善云服务器部署文档和自动化脚本

## 七、 技术架构更新 (Technical Architecture Updates)

**当前技术栈：**
- 后端：Flask + SQLite + Python
- 前端：HTML5 + CSS3 + JavaScript (原生)
- 音频：Cambridge Dictionary API + 本地缓存
- 部署：本地开发环境 + 生产环境支持

**新增功能模块：**
- 错误历史管理系统
- 数据同步模块
- 分页加载组件
- 正确率计算引擎

**性能优化：**
- API响应时间优化
- 数据库查询优化
- 前端渲染性能提升
- 音频文件缓存机制