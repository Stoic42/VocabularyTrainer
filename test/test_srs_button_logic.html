<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SRS按钮逻辑测试</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .test-section {
            border: 2px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
        }
        .test-section.passed {
            border-color: #28a745;
            background-color: #d4edda;
        }
        .test-section.failed {
            border-color: #dc3545;
            background-color: #f8d7da;
        }
        .button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        .button:hover {
            background: #0056b3;
        }
        .button.hidden {
            display: none;
        }
        .status {
            font-weight: bold;
            margin: 10px 0;
        }
        .status.success {
            color: #28a745;
        }
        .status.error {
            color: #dc3545;
        }
        .status.info {
            color: #17a2b8;
        }
        .mock-container {
            border: 1px solid #ccc;
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            background: #f8f9fa;
        }
        .mock-container.hidden {
            display: none;
        }
    </style>
</head>
<body>
    <h1>🧪 SRS按钮逻辑测试</h1>
    
    <div class="container">
        <h2>测试说明</h2>
        <p>本测试页面用于验证SRS复习模式的按钮逻辑优化：</p>
        <ul>
            <li>✅ 统一入口：只有"智能复习"按钮作为主要入口</li>
            <li>✅ 隐藏冗余：SRS模式下隐藏"开始测试"按钮</li>
            <li>✅ 清晰流程：避免多个按钮导致界面臃肿</li>
        </ul>
    </div>

    <div class="container">
        <h2>学习模式选择</h2>
        <select id="study-mode" onchange="testModeChange()">
            <option value="standard">标准模式</option>
            <option value="dictation">默写模式</option>
            <option value="error_review">错词复习模式</option>
            <option value="error_clear">错词清零模式</option>
            <option value="srs_review">SRS复习模式</option>
        </select>
        
        <div class="status" id="mode-status">请选择学习模式</div>
    </div>

    <div class="container">
        <h2>按钮状态测试</h2>
        
        <div class="test-section" id="start-btn-test">
            <h3>开始测试按钮 (start-btn)</h3>
            <button id="start-btn" class="button">开始测试</button>
            <div class="status" id="start-btn-status">状态：显示</div>
            <div class="mock-container" id="start-btn-container">
                <p>这个按钮应该：</p>
                <ul>
                    <li>在所有模式下都显示（包括SRS复习模式）</li>
                    <li>在SRS模式下点击后隐藏所有不相干的div</li>
                    <li>让SRS复习区域在视觉上出现在另一个界面</li>
                </ul>
            </div>
        </div>

        <div class="test-section" id="srs-review-btn-test">
            <h3>智能复习按钮 (srs-review-btn)</h3>
            <button id="srs-review-btn" class="button">🔄 智能复习</button>
            <div class="status" id="srs-review-btn-status">状态：显示</div>
            <div class="mock-container" id="srs-review-btn-container">
                <p>这个按钮应该：</p>
                <ul>
                    <li>只在SRS复习模式下显示</li>
                    <li>点击后直接进入SRS复习流程</li>
                    <li>不再切换学习模式</li>
                </ul>
            </div>
        </div>

        <div class="test-section" id="srs-start-btn-test">
            <h3>SRS开始复习按钮 (srs-start-btn)</h3>
            <button id="srs-start-btn" class="button">🚀 开始SRS复习</button>
            <div class="status" id="srs-start-btn-status">状态：隐藏</div>
            <div class="mock-container" id="srs-start-btn-container">
                <p>这个按钮应该：</p>
                <ul>
                    <li>只在SRS复习模式下显示</li>
                    <li>作为SRS复习的主要入口</li>
                </ul>
            </div>
        </div>
    </div>

    <div class="container">
        <h2>界面容器测试</h2>
        
        <div class="test-section" id="srs-mastery-test">
            <h3>SRS掌握度容器 (srs-mastery-container)</h3>
            <div class="mock-container" id="srs-mastery-container">
                <h4>📚 智能学习进度</h4>
                <p>这个容器应该只在SRS复习模式下显示</p>
            </div>
            <div class="status" id="srs-mastery-status">状态：隐藏</div>
        </div>

        <div class="test-section" id="srs-review-area-test">
            <h3>SRS复习区域 (srs-review-area)</h3>
            <div class="mock-container" id="srs-review-area">
                <h4>🔄 SRS智能复习</h4>
                <p>这个区域应该只在SRS复习模式下显示</p>
            </div>
            <div class="status" id="srs-review-area-status">状态：隐藏</div>
        </div>

        <div class="test-section" id="error-stats-test">
            <h3>错词统计容器 (error-stats-container)</h3>
            <div class="mock-container" id="error-stats-container">
                <h4>📊 错词统计</h4>
                <p>这个容器应该只在错词复习和错词清零模式下显示</p>
            </div>
            <div class="status" id="error-stats-status">状态：隐藏</div>
        </div>
    </div>

    <div class="container">
        <h2>测试结果</h2>
        <div id="test-results">
            <p>请选择学习模式开始测试</p>
        </div>
        <button class="button" onclick="runAllTests()">运行所有测试</button>
        <button class="button" onclick="resetTests()">重置测试</button>
    </div>

    <script>
        let testResults = {
            startBtnLogic: false,
            srsReviewBtnLogic: false,
            srsStartBtnLogic: false,
            containerLogic: false
        };

        function testModeChange() {
            const selectedMode = document.getElementById('study-mode').value;
            const startBtn = document.getElementById('start-btn');
            const srsReviewBtn = document.getElementById('srs-review-btn');
            const srsStartBtn = document.getElementById('srs-start-btn');
            const srsMasteryContainer = document.getElementById('srs-mastery-container');
            const srsReviewArea = document.getElementById('srs-review-area');
            const errorStatsContainer = document.getElementById('error-stats-container');

            // 更新状态显示
            document.getElementById('mode-status').textContent = `当前模式：${getModeName(selectedMode)}`;
            document.getElementById('mode-status').className = 'status info';

            // 测试开始按钮逻辑
            if (selectedMode === 'srs_review') {
                startBtn.classList.remove('hidden');
                document.getElementById('start-btn-status').textContent = '状态：显示 ✅';
                document.getElementById('start-btn-status').className = 'status success';
                testResults.startBtnLogic = true;
            } else {
                startBtn.classList.remove('hidden');
                document.getElementById('start-btn-status').textContent = '状态：显示 ✅';
                document.getElementById('start-btn-status').className = 'status success';
                testResults.startBtnLogic = true;
            }

            // 测试SRS复习按钮逻辑
            if (selectedMode === 'srs_review') {
                srsReviewBtn.classList.remove('hidden');
                document.getElementById('srs-review-btn-status').textContent = '状态：显示 ✅';
                document.getElementById('srs-review-btn-status').className = 'status success';
                testResults.srsReviewBtnLogic = true;
            } else {
                srsReviewBtn.classList.add('hidden');
                document.getElementById('srs-review-btn-status').textContent = '状态：隐藏 ✅';
                document.getElementById('srs-review-btn-status').className = 'status success';
                testResults.srsReviewBtnLogic = true;
            }

            // 测试SRS开始按钮逻辑
            if (selectedMode === 'srs_review') {
                srsStartBtn.classList.remove('hidden');
                document.getElementById('srs-start-btn-status').textContent = '状态：显示 ✅';
                document.getElementById('srs-start-btn-status').className = 'status success';
                testResults.srsStartBtnLogic = true;
            } else {
                srsStartBtn.classList.add('hidden');
                document.getElementById('srs-start-btn-status').textContent = '状态：隐藏 ✅';
                document.getElementById('srs-start-btn-status').className = 'status success';
                testResults.srsStartBtnLogic = true;
            }

            // 测试容器显示逻辑
            let containerTestPassed = true;

            // SRS掌握度容器
            if (selectedMode === 'srs_review') {
                srsMasteryContainer.classList.remove('hidden');
                document.getElementById('srs-mastery-status').textContent = '状态：显示 ✅';
                document.getElementById('srs-mastery-status').className = 'status success';
            } else {
                srsMasteryContainer.classList.add('hidden');
                document.getElementById('srs-mastery-status').textContent = '状态：隐藏 ✅';
                document.getElementById('srs-mastery-status').className = 'status success';
            }

            // SRS复习区域
            if (selectedMode === 'srs_review') {
                srsReviewArea.classList.remove('hidden');
                document.getElementById('srs-review-area-status').textContent = '状态：显示 ✅';
                document.getElementById('srs-review-area-status').className = 'status success';
            } else {
                srsReviewArea.classList.add('hidden');
                document.getElementById('srs-review-area-status').textContent = '状态：隐藏 ✅';
                document.getElementById('srs-review-area-status').className = 'status success';
            }

            // 错词统计容器
            if (selectedMode === 'error_review' || selectedMode === 'error_clear') {
                errorStatsContainer.classList.remove('hidden');
                document.getElementById('error-stats-status').textContent = '状态：显示 ✅';
                document.getElementById('error-stats-status').className = 'status success';
            } else {
                errorStatsContainer.classList.add('hidden');
                document.getElementById('error-stats-status').textContent = '状态：隐藏 ✅';
                document.getElementById('error-stats-status').className = 'status success';
            }

            testResults.containerLogic = containerTestPassed;

            // 更新测试区域样式
            updateTestSectionStyles();
        }

        function getModeName(mode) {
            const modeNames = {
                'standard': '标准模式',
                'dictation': '默写模式',
                'error_review': '错词复习模式',
                'error_clear': '错词清零模式',
                'srs_review': 'SRS复习模式'
            };
            return modeNames[mode] || mode;
        }

        function updateTestSectionStyles() {
            const sections = document.querySelectorAll('.test-section');
            sections.forEach(section => {
                const statusElement = section.querySelector('.status');
                if (statusElement && statusElement.textContent.includes('✅')) {
                    section.classList.add('passed');
                    section.classList.remove('failed');
                } else if (statusElement && statusElement.textContent.includes('❌')) {
                    section.classList.add('failed');
                    section.classList.remove('passed');
                } else {
                    section.classList.remove('passed', 'failed');
                }
            });
        }

        function runAllTests() {
            // 测试所有模式
            const modes = ['standard', 'dictation', 'error_review', 'error_clear', 'srs_review'];
            let currentIndex = 0;

            function testNextMode() {
                if (currentIndex < modes.length) {
                    document.getElementById('study-mode').value = modes[currentIndex];
                    testModeChange();
                    currentIndex++;
                    setTimeout(testNextMode, 1000);
                } else {
                    showFinalResults();
                }
            }

            testNextMode();
        }

        function showFinalResults() {
            const allPassed = Object.values(testResults).every(result => result);
            const resultsDiv = document.getElementById('test-results');
            
            if (allPassed) {
                resultsDiv.innerHTML = `
                    <div class="status success">
                        <h3>🎉 所有测试通过！</h3>
                        <p>SRS按钮逻辑优化成功：</p>
                        <ul>
                            <li>✅ 开始按钮在SRS模式下正确隐藏</li>
                            <li>✅ 智能复习按钮逻辑正确</li>
                            <li>✅ SRS开始按钮显示逻辑正确</li>
                            <li>✅ 容器显示逻辑正确</li>
                        </ul>
                    </div>
                `;
            } else {
                resultsDiv.innerHTML = `
                    <div class="status error">
                        <h3>❌ 部分测试失败</h3>
                        <p>请检查以下项目：</p>
                        <ul>
                            <li>开始按钮逻辑: ${testResults.startBtnLogic ? '✅' : '❌'}</li>
                            <li>智能复习按钮逻辑: ${testResults.srsReviewBtnLogic ? '✅' : '❌'}</li>
                            <li>SRS开始按钮逻辑: ${testResults.srsStartBtnLogic ? '✅' : '❌'}</li>
                            <li>容器显示逻辑: ${testResults.containerLogic ? '✅' : '❌'}</li>
                        </ul>
                    </div>
                `;
            }
        }

        function resetTests() {
            document.getElementById('study-mode').value = 'standard';
            testModeChange();
            document.getElementById('test-results').innerHTML = '<p>测试已重置</p>';
            testResults = {
                startBtnLogic: false,
                srsReviewBtnLogic: false,
                srsStartBtnLogic: false,
                containerLogic: false
            };
        }

        // 模拟按钮点击事件
        document.getElementById('srs-review-btn').addEventListener('click', function() {
            alert('🔄 智能复习按钮被点击！\n\n优化后的行为：\n- 不再切换学习模式\n- 直接进入SRS复习流程\n- 避免了界面臃肿问题');
        });

        document.getElementById('srs-start-btn').addEventListener('click', function() {
            alert('🚀 SRS开始复习按钮被点击！\n\n这是SRS复习的主要入口');
        });

        document.getElementById('start-btn').addEventListener('click', function() {
            const currentMode = document.getElementById('study-mode').value;
            if (currentMode === 'srs_review') {
                alert('🔄 SRS模式下的开始测试按钮被点击！\n\n优化后的行为：\n- 隐藏所有不相干的div\n- 显示SRS复习区域\n- 让复习界面在视觉上出现在另一个界面');
            } else {
                alert('✅ 开始测试按钮正常工作');
            }
        });

        // 初始化测试
        testModeChange();
    </script>
</body>
</html> 